# 搭建授权服务器

```bash
$ WORKING_DIR=/opt/docker/fastapi-dls/cert
$ mkdir -p $WORKING_DIR
$ cd $WORKING_DIR
# create instance private and public key for singing JWT's
$ openssl genrsa -out $WORKING_DIR/instance.private.pem 2048
$ openssl rsa -in $WORKING_DIR/instance.private.pem -outform PEM -pubout -out $WORKING_DIR/instance.public.pem
# create ssl certificate for integrated webserver (uvicorn) - because clients rely on ssl
$ openssl req -x509 -nodes -days 3650 -newkey rsa:2048 -keyout  $WORKING_DIR/webserver.key -out $WORKING_DIR/webserver.crt


You are about to be asked to enter information that will be incorporated
into your certificate request.
What you are about to enter is what is called a Distinguished Name or a DN.
There are quite a few fields but you can leave some blank
For some fields there will be a default value,
If you enter '.', the field will be left blank.
-----
Country Name (2 letter code) [AU]:CN
State or Province Name (full name) [Some-State]:广东省
Locality Name (eg, city) []:深圳市
Organization Name (eg, company) [Internet Widgits Pty Ltd]:深圳高得工程有限公司
Organizational Unit Name (eg, section) []:中国交通建设股份有限公司
Common Name (e.g. server FQDN or YOUR name) []:chengfu
Email Address []:allen2fuc@gmail.com
```



运行docker

```bash
$ docker run -d --restart=always -e DLS_URL=192.168.88.172 -e DLS_PORT=443 -p 443:443 -v $WORKING_DIR:/app/cert collinwebdesigns/fastapi-dls:latest

# docker update --restart=always xxxx
```



**客户机操作**：

1. 客户机访问下载页面：[https://xxx.xxx.xxx.xxx/-/client-token](https://xxx.xxx.xxx.xxx/-/client-token)
2. 下载后存放到`C:\Program Files\NVIDIA Corporation\vGPU Licensing\ClientConfigToken\`目录下
3. 重启客户机

